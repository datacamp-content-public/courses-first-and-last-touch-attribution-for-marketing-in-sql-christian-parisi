---
title: Insert title here
key: e45961e54645c8642fb657be6e20b957

---
## First Touch Attribution in SQL

```yaml
type: "TitleSlide"
key: "fc1a94a7ff"
```

`@lower_third`

name: Christian D. Parisi
title: Head of Data and Analytics, Quidd


`@script`



---
## Lookback Windows

```yaml
type: "FullSlide"
key: "f639924f5d"
```

`@part1`
- Allow us to consider how far back to consider a visit {{1}}

- Differents types of businesses have different considerations for lookback periods  {{2}}


- INTERVAL SQL function allows us to specify how far prior to the first purchase we want to look back.  {{3}}

![](https://assets.datacamp.com/production/repositories/4453/datasets/97a4567b20f4af8515d9c6fc3912f47c20b905ff/interval%20sql.png){{4}}


`@script`
Our first consideration is a lookback window.  These allow us to specify how far back in time we want to look at visits when considering if it was the first touch.  For example, it makes a lot more sense to look at a web visit six months ago for a user that bought a car online but makes less sense for a digital food ordering platform attributing a purchase from last evening.  Point is that different lines of businesses will have different rules for considering lookback periods and this framework can be applied to all.

When we write the SQL query we have the ability to do a calculation with the date using INTERVALS.  In this case, we want to only look at visits that took place within the 30 days prior to the first purchase date.  This is done by subtracting â€“ INTERVAL 30 days from the first purchase date in a where clause to only consider visits in that time frame.


---
## Finding the first visit...

```yaml
type: "FullSlide"
key: "2e2f428c37"
```

`@part1`
- Leverages same aggregate framework as last touch attribution {{1}}

- New function: MIN() {{2}}

- MIN function with grouping by user_id and utm_source {{3}}

- ![](https://assets.datacamp.com/production/repositories/4453/datasets/78b02d4b494e28d25af865f640539c7f7a091a79/first_visit_by_source_and_user_id.png)


`@script`
With a lookback window in hand we will use the same aggregation framework we used for last touch attribution but instead use a new function: MIN().  Just like MAX() gave us the largest value MIN() gives us the smallest value.  You can see we are grouping the querying by the user_id and utm_source and returning the minimum date for that grouping.  

Unfortunately something looks wrong here as each utm_source has its own first visit so we need a method to find which source truly generated the first visit.    This is evident for user_id 1234 who has two "first" visits in our results which are attributed to two different sources.  We need to use a four step SQL process to resolve this issue.


---
## Something looks wrong

```yaml
type: "FullSlide"
key: "c9d0a4fd1f"
```

`@part1`



`@script`



---
## Final Slide

```yaml
type: "FinalSlide"
key: "8439793603"
```

`@script`


